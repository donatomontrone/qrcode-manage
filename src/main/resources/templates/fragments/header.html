<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
</head>
<body>
    <!-- Header Fragment -->
    <header th:fragment="header" class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <!-- Logo and Brand -->
                <div class="flex items-center">
                    <a href="/admin/dashboard" class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-teal-600 to-cyan-600 rounded-xl flex items-center justify-center">
                            <i data-lucide="qr-code" class="w-6 h-6 text-white"></i>
                        </div>
                        <div class="ml-3">
                            <h1 class="text-xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent">
                                QR Manager
                            </h1>
                            <p class="text-xs text-gray-500">Admin Dashboard</p>
                        </div>
                    </a>
                </div>

                <!-- Navigation -->
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="/admin/dashboard" 
                       class="flex items-center text-gray-600 hover:text-teal-600 transition-colors nav-link"
                       data-page="dashboard">
                        <i data-lucide="layout-dashboard" class="w-5 h-5 mr-2"></i>
                        Dashboard
                    </a>
                    <a href="/admin/qr/list" 
                       class="flex items-center text-gray-600 hover:text-teal-600 transition-colors nav-link"
                       data-page="qr">
                        <i data-lucide="list" class="w-5 h-5 mr-2"></i>
                        QR Code
                    </a>
                    <a href="/admin/qr/create" 
                       class="flex items-center text-gray-600 hover:text-teal-600 transition-colors nav-link"
                       data-page="create">
                        <i data-lucide="plus-circle" class="w-5 h-5 mr-2"></i>
                        Nuovo QR
                    </a>
                    <a href="/admin/users" 
                       class="flex items-center text-gray-600 hover:text-teal-600 transition-colors nav-link"
                       data-page="users">
                        <i data-lucide="users" class="w-5 h-5 mr-2"></i>
                        Utenti
                    </a>
                    <a href="/admin/reports" 
                       class="flex items-center text-gray-600 hover:text-teal-600 transition-colors nav-link"
                       data-page="reports">
                        <i data-lucide="bar-chart-3" class="w-5 h-5 mr-2"></i>
                        Report
                    </a>
                </nav>

                <!-- User Menu -->
                <div class="flex items-center space-x-4">
                    <!-- Notifications -->
                    <button class="relative p-2 text-gray-400 hover:text-gray-600 transition-colors">
                        <i data-lucide="bell" class="w-5 h-5"></i>
                        <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
                    </button>

                    <!-- User Dropdown -->
                    <div class="relative">
                        <button class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 transition-colors">
                            <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
                                <span class="text-sm font-medium text-white">A</span>
                            </div>
                            <div class="hidden sm:block text-left">
                                <p class="text-sm font-medium text-gray-900">Admin User</p>
                                <p class="text-xs text-gray-500">Amministratore</p>
                            </div>
                            <i data-lucide="chevron-down" class="w-4 h-4 text-gray-400"></i>
                        </button>

                        <!-- Dropdown Menu (hidden by default) -->
                        <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 hidden">
                            <div class="py-1">
                                <a href="/admin/profile" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">
                                    <i data-lucide="user" class="w-4 h-4 mr-3"></i>
                                    Il mio Profilo
                                </a>
                                <a href="/admin/settings" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50">
                                    <i data-lucide="settings" class="w-4 h-4 mr-3"></i>
                                    Impostazioni
                                </a>
                                <div class="border-t border-gray-100 my-1"></div>
                                <a href="/logout" class="flex items-center px-4 py-2 text-sm text-red-700 hover:bg-red-50">
                                    <i data-lucide="log-out" class="w-4 h-4 mr-3"></i>
                                    Logout
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mobile menu button -->
                <div class="md:hidden">
                    <button class="p-2 text-gray-600 hover:text-gray-900 transition-colors">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Navigation (hidden by default) -->
        <div class="md:hidden border-t border-gray-200 bg-gray-50 hidden">
            <div class="px-4 pt-2 pb-3 space-y-1">
                <a href="/admin/dashboard" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-600 hover:bg-white rounded-lg">Dashboard</a>
                <a href="/admin/qr/list" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-600 hover:bg-white rounded-lg">QR Code</a>
                <a href="/admin/qr/create" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-600 hover:bg-white rounded-lg">Nuovo QR</a>
                <a href="/admin/users" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-600 hover:bg-white rounded-lg">Utenti</a>
                <a href="/admin/reports" class="block px-3 py-2 text-base font-medium text-gray-700 hover:text-teal-600 hover:bg-white rounded-lg">Report</a>
            </div>
        </div>
    </header>

    <script>
        // Initialize Lucide icons for header
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }

        // Active navigation highlighting using JavaScript (no #request needed!)
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');

            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (currentPath === href || 
                    (href === '/admin/dashboard' && currentPath === '/') ||
                    (href !== '/admin/dashboard' && currentPath.startsWith(href))) {
                    link.classList.add('text-teal-600', 'font-medium');
                    link.classList.remove('text-gray-600');
                }
            });
        });
    </script>
</body>
</html>